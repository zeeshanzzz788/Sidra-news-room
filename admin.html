<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin • Sidra News Room</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Playfair+Display:wght@700&display=swap');
    </style>
</head>
<body class="bg-zinc-950 text-white min-h-screen">

    <!-- LOGIN SCREEN -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center px-4">
        <div class="bg-zinc-900 p-8 md:p-10 rounded-3xl w-full max-w-md">
            <div class="flex justify-center mb-8">
                <img src="https://pbs.twimg.com/profile_images/1993382470054543360/UHU6o--k.jpg" class="h-20">
            </div>
            <h1 class="text-3xl font-bold text-center mb-2">Sidra News Room</h1>
            <p class="text-center text-zinc-400 mb-10">Admin Dashboard</p>
            
            <input id="username" type="text" value="admin" placeholder="Username" 
                   class="block w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-4 mb-4 text-base">
            
            <input id="password" type="password" placeholder="Password" 
                   class="block w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-4 mb-8 text-base">
            
            <button onclick="attemptLogin()" 
                    class="w-full bg-[#bb1919] hover:bg-red-700 py-5 rounded-2xl font-bold text-lg active:scale-95 transition-transform">
                LOGIN TO DASHBOARD
            </button>
        </div>
    </div>

    <!-- ADMIN PANEL (mobile optimized) -->
    <div id="adminPanel" class="hidden">
        <nav class="bg-zinc-900 border-b border-zinc-700 px-4 py-4 md:px-8 flex items-center justify-between sticky top-0 z-50">
            <div class="flex items-center gap-3">
                <img src="https://pbs.twimg.com/profile_images/1993382470054543360/UHU6o--k.jpg" class="h-9">
                <span class="font-bold text-xl md:text-2xl">SIDRA NEWS ROOM <span class="text-xs text-emerald-400">ADMIN</span></span>
            </div>
            <button onclick="logout()" class="px-5 py-3 bg-red-900 hover:bg-red-800 rounded-2xl text-sm font-medium flex items-center gap-2 active:scale-95">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </nav>

        <div class="max-w-6xl mx-auto p-4 md:p-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
                <h1 class="text-3xl md:text-4xl font-bold">All Articles</h1>
                <button onclick="showNewForm()" class="bg-emerald-600 hover:bg-emerald-700 w-full md:w-auto px-8 py-4 rounded-2xl font-semibold flex items-center justify-center gap-3 active:scale-95">
                    <i class="fas fa-plus"></i> NEW ARTICLE
                </button>
            </div>

            <div class="bg-zinc-900 rounded-3xl overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-[600px]">
                        <thead>
                            <tr class="text-xs md:text-sm text-zinc-400 border-b border-zinc-700 bg-zinc-950">
                                <th class="text-left px-6 py-5 font-normal">TITLE</th>
                                <th class="text-left px-6 py-5 font-normal">CATEGORY</th>
                                <th class="text-left px-6 py-5 font-normal">DATE</th>
                                <th class="text-center px-6 py-5 font-normal">ACTIONS</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-zinc-700 text-sm"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Article Form -->
        <div id="formOverlay" class="hidden fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4">
            <div class="bg-zinc-900 w-full max-w-2xl rounded-3xl max-h-[92vh] overflow-auto">
                <div class="p-6 md:p-8">
                    <div class="flex justify-between items-center mb-8">
                        <h2 id="formHeader" class="text-2xl md:text-3xl font-bold">New Article</h2>
                        <button onclick="hideForm()" class="text-3xl text-zinc-400 hover:text-white">×</button>
                    </div>
                    <form id="articleForm" onsubmit="saveArticle(event)">
                        <input type="hidden" id="editId">
                        <div class="space-y-6">
                            <input id="title" required placeholder="Article Title" class="w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-5 text-base">
                            <select id="category" class="w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-5 text-base">
                                <option value="SidraChain">SidraChain</option>
                                <option value="DeFi">DeFi & Markets</option>
                                <option value="Shariah">Shariah Finance</option>
                                <option value="Community">Community</option>
                            </select>
                            <input id="image" placeholder="Image URL (optional)" class="w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-5 text-base">
                            <textarea id="excerpt" rows="3" placeholder="Short excerpt" class="w-full bg-zinc-800 border border-zinc-700 rounded-2xl px-6 py-5 text-base"></textarea>
                            <textarea id="content" rows="10" placeholder="Full article content" class="w-full bg-zinc-800 border border-zinc-700 rounded-3xl px-6 py-5 text-base"></textarea>
                        </div>
                        <div class="flex flex-col md:flex-row gap-4 mt-10">
                            <button type="submit" class="flex-1 bg-emerald-600 hover:bg-emerald-700 py-5 rounded-2xl font-bold text-lg active:scale-95">SAVE ARTICLE</button>
                            <button type="button" onclick="hideForm()" class="flex-1 bg-zinc-800 hover:bg-zinc-700 py-5 rounded-2xl font-bold text-lg active:scale-95">CANCEL</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Password is now obfuscated with Base64 – not visible in plain text
        const CORRECT_ENCODED = "U2lkcmFOZXdzUm9vbUAyMDMw";   // Base64 of "SidraNewsRoom@2030"

        let articles = JSON.parse(localStorage.getItem('sidraArticles')) || [];

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            articles.forEach((a, i) => {
                tbody.innerHTML += `
                    <tr class="hover:bg-zinc-800">
                        <td class="px-6 py-5">${a.title}</td>
                        <td class="px-6 py-5">${a.category}</td>
                        <td class="px-6 py-5">${a.date}</td>
                        <td class="px-6 py-5 text-center">
                            <button onclick="editArticle(${i})" class="text-sky-400 hover:text-white mx-3 text-xl"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteArticle(${i})" class="text-red-400 hover:text-white mx-3 text-xl"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }

        function attemptLogin() {
            const entered = document.getElementById('password').value.trim();
            if (btoa(entered) === CORRECT_ENCODED) {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                renderTable();
                localStorage.setItem('sidraAdminLogged', 'true');
            } else {
                alert("❌ Incorrect password");
            }
        }

        function logout() {
            if (confirm("Logout from admin?")) {
                localStorage.removeItem('sidraAdminLogged');
                location.reload();
            }
        }

        function showNewForm() {
            document.getElementById('formHeader').textContent = "New Article";
            document.getElementById('articleForm').reset();
            document.getElementById('editId').value = "";
            document.getElementById('formOverlay').classList.remove('hidden');
        }

        function hideForm() {
            document.getElementById('formOverlay').classList.add('hidden');
        }

        function saveArticle(e) {
            e.preventDefault();
            const newArt = {
                id: Date.now(),
                title: document.getElementById('title').value,
                category: document.getElementById('category').value,
                date: "21 Feb 2026",
                image: document.getElementById('image').value || "https://picsum.photos/id/1015/800/500",
                excerpt: document.getElementById('excerpt').value,
                content: document.getElementById('content').value
            };
            const editIndex = document.getElementById('editId').value;
            if (editIndex) articles[editIndex] = newArt;
            else articles.unshift(newArt);
            
            localStorage.setItem('sidraArticles', JSON.stringify(articles));
            renderTable();
            hideForm();
            alert("✅ Article saved! Refresh public site to see it live.");
        }

        function editArticle(i) { /* same as before */ 
            const a = articles[i];
            document.getElementById('formHeader').textContent = "Edit Article";
            document.getElementById('editId').value = i;
            document.getElementById('title').value = a.title;
            document.getElementById('category').value = a.category;
            document.getElementById('image').value = a.image;
            document.getElementById('excerpt').value = a.excerpt;
            document.getElementById('content').value = a.content;
            document.getElementById('formOverlay').classList.remove('hidden');
        }

        function deleteArticle(i) {
            if (confirm("Delete permanently?")) {
                articles.splice(i, 1);
                localStorage.setItem('sidraArticles', JSON.stringify(articles));
                renderTable();
            }
        }

        window.onload = () => {
            if (localStorage.getItem('sidraAdminLogged') === 'true') {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                renderTable();
            }
        };
    </script>
</body>
</html>
